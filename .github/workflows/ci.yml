name: CI

on:
  push:
    paths:
      - 'openvidu-call-front/**'

jobs:
  ovcall_unit_test:
    name: OpenVidu Call unit tests
    runs-on: ubuntu-16.04
    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-node@v1
      with:
        node-version: '12.x'
    - name: Remove package-lock
      run: rm openvidu-call-front/package-lock.json
    - name: Install dependencies
      run: npm install --prefix openvidu-call-front
    - name: Run unit tests
      run: npm run test --prefix openvidu-call-front

  build_library:
    name: Build OpenVidu angular library
    runs-on: ubuntu-16.04
    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-node@v1
      with:
        node-version: '12.x'
    - name: Build openvidu-agular
      run: npm run build:openvidu-angular --prefix openvidu-call-front

  build_webcomponent:
    name: Build OpenVidu Webcomponent
    runs-on: ubuntu-16.04
    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-node@v1
      with:
        node-version: '12.x'
    - name: Build openvidu-webcomponent
      run: npm run build:openvidu-webcomponent --prefix openvidu-call-front